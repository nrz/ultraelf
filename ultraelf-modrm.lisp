;;;; ultraELF 0.0.1
;;;
;;; ultraELF x86-64 assembler, disassembler and metamorphic engine.
;;; ultraELF packs and reconstructs ELF executables, maintaining original functionality.

(in-package :ultraelf)

(defparameter *modrm-reg-hash-table-x64* (make-hash-table :test 'equalp))
(setf (gethash "al"   *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "cl"   *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "dl"   *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "bl"   *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "ah"   *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "ch"   *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "dh"   *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "bh"   *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "ax"   *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "cx"   *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "dx"   *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "bx"   *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "sp"   *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "bp"   *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "si"   *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "di"   *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "eax"  *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "ecx"  *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "edx"  *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "ebx"  *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "esp"  *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "ebp"  *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "esi"  *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "edi"  *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "rax"  *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "rcx"  *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "rdx"  *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "rbx"  *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "rsp"  *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "rbp"  *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "rsi"  *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "rdi"  *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "spl"  *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "bpl"  *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "sil"  *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "dil"  *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "r8b"  *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "r9b"  *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "r10b" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "r11b" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "r12b" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "r13b" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "r14b" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "r15b" *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "r8w"  *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "r9w"  *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "r10w" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "r11w" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "r12w" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "r13w" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "r14w" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "r15w" *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "r8d"  *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "r9d"  *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "r10d" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "r11d" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "r12d" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "r13d" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "r14d" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "r15d" *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "r8"   *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "r9"   *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "r10"  *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "r11"  *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "r12"  *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "r13"  *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "r14"  *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "r15"  *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "mmx0" *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "mmx1" *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "mmx2" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "mmx3" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "mmx4" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "mmx5" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "mmx6" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "mmx7" *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "xmm0" *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "xmm1" *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "xmm2" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "xmm3" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "xmm4" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "xmm5" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "xmm6" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "xmm7" *modrm-reg-hash-table-x64*) #b111)
(setf (gethash "ymm0" *modrm-reg-hash-table-x64*) #b000)
(setf (gethash "ymm1" *modrm-reg-hash-table-x64*) #b001)
(setf (gethash "ymm2" *modrm-reg-hash-table-x64*) #b010)
(setf (gethash "ymm3" *modrm-reg-hash-table-x64*) #b011)
(setf (gethash "ymm4" *modrm-reg-hash-table-x64*) #b100)
(setf (gethash "ymm5" *modrm-reg-hash-table-x64*) #b101)
(setf (gethash "ymm6" *modrm-reg-hash-table-x64*) #b110)
(setf (gethash "ymm7" *modrm-reg-hash-table-x64*) #b111)


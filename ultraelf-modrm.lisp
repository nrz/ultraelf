;;;; ultraELF 0.0.1
;;;
;;; ultraELF x86-64 assembler, disassembler and metamorphic engine.
;;; ultraELF packs and reconstructs ELF executables, maintaining original functionality.

(in-package :ultraelf)

(defparameter *r/m-reg-hash-table-x64* (make-hash-table :test 'equalp))
(setf (gethash "al"    *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "cl"    *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "dl"    *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "bl"    *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "ah"    *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "ch"    *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "dh"    *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "bh"    *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "ax"    *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "cx"    *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "dx"    *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "bx"    *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "sp"    *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "bp"    *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "si"    *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "di"    *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "eax"   *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "ecx"   *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "edx"   *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "ebx"   *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "esp"   *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "ebp"   *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "esi"   *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "edi"   *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "rax"   *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "rcx"   *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "rdx"   *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "rbx"   *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "rsp"   *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "rbp"   *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "rsi"   *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "rdi"   *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "spl"   *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "bpl"   *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "sil"   *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "dil"   *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "r8b"   *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "r9b"   *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "r10b"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "r11b"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "r12b"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "r13b"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "r14b"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "r15b"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "r8w"   *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "r9w"   *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "r10w"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "r11w"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "r12w"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "r13w"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "r14w"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "r15w"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "r8d"   *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "r9d"   *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "r10d"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "r11d"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "r12d"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "r13d"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "r14d"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "r15d"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "r8"    *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "r9"    *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "r10"   *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "r11"   *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "r12"   *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "r13"   *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "r14"   *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "r15"   *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "mmx0"  *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "mmx1"  *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "mmx2"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "mmx3"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "mmx4"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "mmx5"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "mmx6"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "mmx7"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "xmm0"  *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "xmm1"  *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "xmm2"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "xmm3"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "xmm4"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "xmm5"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "xmm6"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "xmm7"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "ymm0"  *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "ymm1"  *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "ymm2"  *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "ymm3"  *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "ymm4"  *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "ymm5"  *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "ymm6"  *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "ymm7"  *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "[rax]" *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "[rcx]" *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "[rdx]" *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "[rbx]" *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "[rsp]" *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "[rbp]" *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "[rsi]" *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "[rdi]" *r/m-reg-hash-table-x64*) #b111)
(setf (gethash "[r8]"  *r/m-reg-hash-table-x64*) #b000)
(setf (gethash "[r9]"  *r/m-reg-hash-table-x64*) #b001)
(setf (gethash "[r10]" *r/m-reg-hash-table-x64*) #b010)
(setf (gethash "[r11]" *r/m-reg-hash-table-x64*) #b011)
(setf (gethash "[r12]" *r/m-reg-hash-table-x64*) #b100)
(setf (gethash "[r13]" *r/m-reg-hash-table-x64*) #b101)
(setf (gethash "[r14]" *r/m-reg-hash-table-x64*) #b110)
(setf (gethash "[r15]" *r/m-reg-hash-table-x64*) #b111)

;;;; ultraELF 0.0.1
;;;
;;; ultraELF x86-64 assembler, disassembler and metamorphic engine.
;;; ultraELF packs and reconstructs ELF executables, maintaining original functionality.

(in-package :ultraelf)

(defparameter *reg-type-hash-table-x64* (make-hash-table :test 'equalp))
(setf (gethash "al"    *reg-type-hash-table-x64*) "old-8-bit-low-reg")
(setf (gethash "cl"    *reg-type-hash-table-x64*) "old-8-bit-low-reg")
(setf (gethash "dl"    *reg-type-hash-table-x64*) "old-8-bit-low-reg")
(setf (gethash "bl"    *reg-type-hash-table-x64*) "old-8-bit-low-reg")
(setf (gethash "ah"    *reg-type-hash-table-x64*) "old-8-bit-high-reg")
(setf (gethash "ch"    *reg-type-hash-table-x64*) "old-8-bit-high-reg")
(setf (gethash "dh"    *reg-type-hash-table-x64*) "old-8-bit-high-reg")
(setf (gethash "bh"    *reg-type-hash-table-x64*) "old-8-bit-high-reg")
(setf (gethash "ax"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "cx"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "dx"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "bx"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "bp"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "sp"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "si"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "di"    *reg-type-hash-table-x64*) "old-16-bit-reg")
(setf (gethash "eax"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "ecx"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "edx"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "ebx"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "ebp"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "esp"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "esi"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "edi"   *reg-type-hash-table-x64*) "old-32-bit-reg")
(setf (gethash "rax"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rcx"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rdx"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rbx"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rbp"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rsp"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rsi"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "rdi"   *reg-type-hash-table-x64*) "old-64-bit-reg")
(setf (gethash "spl"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-l")
(setf (gethash "bpl"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-l")
(setf (gethash "sil"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-l")
(setf (gethash "dil"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-l")
(setf (gethash "r8b"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r9b"   *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r10b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r11b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r12b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r13b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r14b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r15b"  *reg-type-hash-table-x64*) "new-8-bit-low-reg-b")
(setf (gethash "r8w"   *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r9w"   *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r10w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r11w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r12w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r13w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r14w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r15w"  *reg-type-hash-table-x64*) "new-16-bit-reg")
(setf (gethash "r8d"   *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r9d"   *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r10d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r11d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r12d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r13d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r14d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r15d"  *reg-type-hash-table-x64*) "new-32-bit-reg")
(setf (gethash "r8"    *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r9"    *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r10"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r11"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r12"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r13"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r14"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "r15"   *reg-type-hash-table-x64*) "new-64-bit-reg")
(setf (gethash "xmm0"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm1"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm2"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm3"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm4"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm5"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm6"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm7"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm8"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm9"  *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm10" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm11" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm12" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm13" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm14" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "xmm15" *reg-type-hash-table-x64*) "sse-xmm-reg")
(setf (gethash "ymm0"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm1"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm2"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm3"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm4"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm5"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm6"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm7"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm8"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm9"  *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm10" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm11" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm12" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm13" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm14" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "ymm15" *reg-type-hash-table-x64*) "avx-ymm-reg")
(setf (gethash "[rax]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[rcx]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[rdx]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[rbx]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[rsp]" *reg-type-hash-table-x64*) "register-indirect-with-SIB")
(setf (gethash "[rbp]" *reg-type-hash-table-x64*) "register-indirect-with-SIB")
(setf (gethash "[rsi]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[rdi]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r8]"  *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r9]"  *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r10]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r11]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r12]" *reg-type-hash-table-x64*) "register-indirect-with-SIB")
(setf (gethash "[r13]" *reg-type-hash-table-x64*) "register-indirect-with-SIB")
(setf (gethash "[r14]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
(setf (gethash "[r15]" *reg-type-hash-table-x64*) "register-indirect-without-SIB")
